<style type="text/css">

body.gradient.page.inspiration a.header__heading-link{
    top: 0px !important;
}

.gallery {
    column-count: 3;
    column-gap: 17px;
    padding: 0px;
}

.gallery-item {
    break-inside: avoid;
    background-color: transparent;
    border-radius: 8px;
    box-shadow: none;
    padding-bottom: 60px;
    overflow: hidden;
    text-align: left;
    display: none;
    position: relative;
}

button#load-more-button {
    line-height: 23px;
}

.gallery-item p{
    margin: 0px;
}

.gallery-section p a {
    color: rgba(41, 37, 33, 1);
    border-bottom: 1px solid rgba(41, 37, 33, 1);
}

/* .gallery-item {
  margin:-1.5px;
} */

.gallery-item img {
    width: 100%;
    height: auto;
    display: block;
    border-radius: 8px;
    object-fit: contain;
}

.gallery-caption {
    padding: 16px 0px 0px;
    margin: 0;
    text-align: left;
}

.gallery-caption p{
    font-size: 16px;
    line-height: 26px;
    font-weight: 450;
    text-align: left;
    letter-spacing: 0.65px;
    color: rgba(41, 37, 33, 1);
}

.gallery-caption a{
    color: rgba(41, 37, 33, 1);
}

.gallery-item:hover .gallery-plus-icon {
    opacity: 1;
    visibility: visible;
}

div#image-modal img#modal-image {
    object-fit: contain;
}

@media screen and (max-width: 767px) {
    .gallery {
        column-count: 1;
        column-gap: 10px;
        padding: 0px 0px 10px 0px;
    }
    h1.main-page-title.page-title{
        margin-bottom: 9px;
        padding-bottom:10px
    }
    .gallery-section.page-width {
        padding: 0px 20px 115px !important;
    }
    .load-more button {
        width: 100%;
    }
    .gallery-plus-icon{
        opacity: 1 !important;
        visibility: visible !important;
    }
    .gallery-item{
        padding-bottom: 40px;
    }
}

.load-more {
    text-align: center;
}

.gallery-section.page-width{
    padding-bottom: 13.889vw;
}

/*
** Gallery Modal
*/
.modal {
    display: none;
    position: fixed;
    z-index: 9999;
    padding: 20px 0px;
    left: 0;
    top: 0;
    width: 100%;
    height: 100vh;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.9);
}

.modal-content {
    margin: auto;
    display: block;
    width: 80%;
    max-width: 700px;
    height: 100%;
}

.close {
    position: absolute;
    top: 15px;
    right: 35px;
    color: #fff;
    font-size: 40px;
    font-weight: bold;
    transition: 0.3s;
}

.close:hover,
.close:focus {
    color: #bbb;
    text-decoration: none;
    cursor: pointer;
}

.modal-content {
    animation-name: zoom;
    animation-duration: 0.6s;
}

.gallery-plus-icon {
    width: 36px !important;
    height: 36px !important;
    object-fit: contain;
    position: absolute;
    right: 20px;
    top: 20px;
    transition: 0.3s all;
    opacity: 0;
    visibility: hidden;
    cursor: pointer;
}

@keyframes zoom {
    from {transform: scale(0)}
    to {transform: scale(1)}
}



</style>



<div class="gallery-section page-width">
    <div class="gallery" id="gallery">
        {% for block in section.blocks %}
            <div id="gal-item-{{ forloop.index }}" class="gallery-item" {% if forloop.index <= 9 %} style="display: block;" {% endif %}>
                <svg class="gallery-plus-icon" width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="36" height="36" rx="18" fill="#F9F6F3"></rect>
                    <path d="M17.7167 12L17.7167 25M11 18.5H17.7167H24" stroke="#292521" stroke-width="1.5"></path>
                </svg>
                <img class="gallery-imgs" src="{{ block.settings.image | img_url: 'master' }}" width="394" height="1000" alt="{{ block.settings.image_alt }}" />
                {% if customer %}
                    {% if block.settings.caption_dealer != blank %}
                        <div class="gallery-caption font-neue-roman">{{ block.settings.caption_dealer }}</div>
                    {% endif %}
                {% else %}
                    {% if block.settings.caption != blank %}
                        <div class="gallery-caption font-neue-roman">{{ block.settings.caption }}</div>
                    {% endif %}
                {% endif %}
                
            </div>
        {% endfor %}
    </div>
    {% if section.blocks.size > 9 %}
    <div class="load-more">
        <button id="load-more-button" class="tranparent-btn-style font-neue-roman">Load More</button>
    </div>
    {% endif %}
</div>

<!-- Modal Structure -->
<div id="image-modal" class="modal" style="display: none;">
    <span class="close" id="modal-close">
        <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="36" height="36" rx="18" fill="#F9F6F3"></rect>
            <path d="M13.057 13.7506L22.2494 22.943M12.9038 23.0962L17.6532 18.3468L22.0962 13.9038" stroke="#292521" stroke-width="1.5"></path>
        </svg>
    </span>
    <img class="modal-content" id="modal-image" width="750" height="1000" >
</div>

<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function () {
    //console.log("DOM fully loaded and parsed");

    let loadMoreButton = document.getElementById('load-more-button');
    let galleryItems = document.querySelectorAll('.gallery-item');
    let plusIcons = document.querySelectorAll('.gallery-plus-icon');
    let itemsPerPage = 9;
    let currentIndex = itemsPerPage;

    // Modal elements
    let modal = document.getElementById('image-modal');
    let modalImage = document.getElementById('modal-image');
    let modalClose = document.getElementById('modal-close');

    // Open Modal on Plus Icon Click
    plusIcons.forEach(function(icon) {
        icon.addEventListener('click', function(event) {
            event.stopPropagation(); // Prevent the click from affecting parent elements
            console.log("Plus icon clicked");
            let imgSrc = this.nextElementSibling.src; // Get the image next to the plus icon
            modalImage.src = imgSrc;
            modal.style.display = 'block';
        });
    });

    // Close Modal
    modalClose.addEventListener('click', function() {
        console.log("Modal close button clicked");
        modal.style.display = 'none';
    });

    // Load More Functionality
    if (loadMoreButton) {
        loadMoreButton.addEventListener('click', function () {
            console.log("Load More button clicked");
            let nextIndex = currentIndex + itemsPerPage;

            for (let i = currentIndex; i < nextIndex && i < galleryItems.length; i++) {
                galleryItems[i].style.display = 'block';
                console.log(`Displaying item ${i + 1}`);
            }

            currentIndex = nextIndex;

            if (currentIndex >= galleryItems.length) {
                loadMoreButton.style.display = 'none';
                console.log("All items displayed, hiding Load More button");
            }
        });
    } else {
        //console.error("Load More button not found");
    }
});


</script>

{% schema %}
{
    "name": "Gallery Section",
    "settings": [
        {
            "type": "text",
            "id": "title",
            "label": "Gallery Title",
            "default": "Our Gallery"
        }
    ],
    "blocks": [
        {
            "type": "image",
            "name": "Image",
            "settings": [
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                },
                {
                    "type": "text",
                    "id": "image_alt",
                    "label": "Alt Text",
                    "default": "Gallery Image"
                },
                {
                    "type": "richtext",
                    "id": "caption",
                    "label": "Caption - Homeowner"
                },
                {
                    "type": "richtext",
                    "id": "caption_dealer",
                    "label": "Caption - Dealer"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "Default Gallery",
            "category": "Gallery"
        }
    ]
}
{% endschema %}
