<section class="animated-tabs-section">
    <div class="container">
        <h2 class="full-width-section-title font-neue-light">{{ section.settings.main_title }} <span class="font-austin-italic">{{ section.settings.main_subtitle }}</span></h2>
        {% if customer %}
            {% if section.settings.main_txt_url_dealer != blank %}
                <a class="learn-more-arrow btn-transparent series-configure font-neue-roman" href="{{ section.settings.main_txt_url_dealer }}">Configure</a>
            {% endif %}
        {% else %}
            {% if section.settings.main_txt_url_homeowner != blank %}
                <a class="learn-more-arrow btn-transparent series-configure font-neue-roman" href="{{ section.settings.main_txt_url_homeowner }}">Configure</a>
            {% endif %}
        {% endif %}
        
        <div class="series-animated-tabs" style="background: url({{ 'tab-section-bg.png' | asset_url }}) no-repeat;">
            <!-- Left side Tabs -->
            <div class="series-tabs">
                {% for block in section.blocks %}
                  {% if block.type == 'text_block' %}
                  {% assign loop_index = forloop.index %}
                      <div class="series-tab font-calling-code activetab" data-index="{{ loop_index | minus: 1 }}"><img src="{{ block.settings.tab_icon | image_url }}" width="30" height="30" alt="tab icon" /> <span class="series-tab-text">{{ block.settings.tab_heading }}</span></div>
                  {% endif %}
                {% endfor %}
            </div>

            <!-- Right side Carousel -->
            <div class="series-carousel">

                {% for block in section.blocks %}
                  {% if block.type == 'text_block' %}
                  {% assign loop_index = forloop.index %}

                    <div class="slide {% if loop_index == 0 %} activetab {% endif %}">
                        <img src="{{ block.settings.tab_main_img | image_url }}" width="716" height="716" alt="Slide {{ loop_index }}">
                        <div class="content">
                            <h2 class="font-neue-roman">{{ block.settings.tab_heading }}</h2>
                            <p class="font-neue-roman">{{ block.settings.tab_content }}</p>
                            <div class="carousel-bottom-paginations">
                                <div class="series-pagination font-neue-roman"></div>
                                <div class="series-dots">
                                    <span class="series-dot activetab" data-index="0"></span>
                                    <span class="series-dot" data-index="1"></span>
                                    <span class="series-dot" data-index="2"></span>
                                </div>
                            </div> 
                        </div>
                    </div>
                    
                  {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<style type="text/css">
    .full-width-section-title {
        text-align: center;
        margin: 0px;
        font-size: 5.556vw;
        line-height: 4.653vw;
        margin-bottom: 35px;
    }

    .full-width-section-title span{
        line-height: 6.111vw;
    }
    
    section.animated-tabs-section a.learn-more-arrow{
        margin-top: 0px;
    }

    /*
    ** Tabs working
    */
    section.animated-tabs-section {
        position: relative;
    }
    .series-animated-tabs {
        display: flex;
        position: relative;
        background-size: contain;
        background-position: 38% 0% !important;
        height: 728px;
    }
    .series-animated-tabs .series-carousel .content {
        background: #f9f6f3;
        padding: 50px 30px 30px 30px;
        border-radius: 8px;
        width: 355px;
        min-width: 355px;
        max-height: 449px;
        margin: 0px;
        position: relative;
        left: -10px;
        top: -52px;
    }
    .series-pagination {
        text-align: center;
        font-size: 14px;
        color: #292521;
    }
    .carousel-bottom-paginations {
        display: flex;
        justify-content: space-between;
    }
    .series-animated-tabs .series-carousel .content h2 {
        font-size: 30px;
        line-height: 42px;
        margin: 0px;
        letter-spacing: 0.65px;
        color: rgba(41, 37, 33, 1);
        border-bottom: 1.5px solid rgba(41, 37, 33, 1);
        padding-bottom: 14px;
    }
    .series-animated-tabs .series-carousel .content p {
        margin-top: 14px;
        color: rgba(90, 88, 87, 1);
        font-size: 16px;
        line-height: 26px;
        margin-bottom: 39px;
    }
    .series-tabs {
        width: max-content;
        display: flex;
        flex-direction: column;
    }

    .series-tabs img{
        max-width: 30px;
        max-height: 30px;
        width: 30px;
        height: 30px;
    }

    .series-tab {
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0px 20px;
        text-transform: uppercase;
        margin-bottom: 28px;
        font-size: 14px;
        line-height: 26px;
        letter-spacing: 0.65px;
        opacity: 0.4;
    }

    .series-tab.activetab{
        opacity: 1;
    }

    .series-carousel {
        width: 80%;
        padding-left: 20px;
    }

    .slide {
        display: none;
        animation: fadein 0.5s;
    }

    .slide.activetab {
        display: flex;
        align-items: center;
    }

    .series-animated-tabs .slide img {
        width: 716px;
        position: relative;
        top: -65px;
        right: 0px;
    }

    .content {
        margin-top: 10px;
    }

    .series-dots {
        display: flex;
        align-items: center;
        gap: 0px 38px;
        justify-content: flex-end;
    }

    .series-dot {
        height: 9px;
        width: 9px;
        background-color: rgba(194, 191, 186, 1);
        border-radius: 50%;
        display: inline-block;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .series-dot.activetab {
        background-color: rgba(41, 37, 33, 1);
    }

    .series-configure{
        margin: 0 auto 98px;
        width: 130px;
        min-width: unset !important;
        gap: 0px;
    }

    @keyframes fadein {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    .modal-action-btns svg {
        width: 18.06px;
    }

    .modal-action-btns svg .cls-1, 
    .modal-action-btns svg .cls-2{
        stroke: rgba(249, 246, 243, 1);
    }

    .modal-action-btns button.disabled {
        pointer-events: none;
    }

    /*
    ** Responsive
    */

    @media (min-width: 1500px){
        .full-width-section-title {
            font-size: 80px;
            line-height: 67px;
            margin-bottom: 35px;
        }  
        
        .full-width-section-title span{
            line-height: 88px;
        }
    }

    @media (max-width: 1300px){
        .series-animated-tabs .slide img{
            width: 70%;
        }
    }

    @media (min-width: 992px) and (max-width: 1100px){
        .series-animated-tabs .slide img {
            width: 60%;
        }
        .series-animated-tabs{
            height: auto;
        }
    }

    @media (max-width: 991px){
        .full-width-section-title {
            font-size: 60px;
            line-height: 64px;
        }

        .full-width-section-title span{
            font-size: 64px;
            line-height: 68px;
        }

        .series-configure{
            margin-bottom: 40px;
        }
        .series-animated-tabs .series-carousel .content p{
            margin-bottom: 41px;
        }
        .full-width-section-title{
            margin-bottom: 30px;
        }
        .series-animated-tabs{
            flex-wrap: wrap;
            background-position: 90% 100% !important;
            background-size: 670px !important;
            height: auto;
        }
        .series-tabs{
            width: 100%;
            flex-wrap: wrap !important;
            flex-flow: row;
            gap: 0px 28px;
        }
        .series-tab {
            gap: 16px;
            width: calc(33.33% - 19px);
            min-width: max-content;
        }
        .series-carousel{
            width: 100%;
            padding-left: 0px;
        }
        .series-animated-tabs .series-carousel .content{
            width: 296px;
            margin: 0 auto;
            padding: 25px 30px;
            left: 0px;
            height: auto;
            top: unset;
            max-width: 100%;
            min-width: unset;
        }
        .series-animated-tabs .slide img{
            width: 100%;
            top: 0px;
            margin-left: 0px;
        }
        .slide.activetab{
            flex-wrap: wrap;
        }
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const tabs = document.querySelectorAll('.series-tab');
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.series-dot');
        const totalSlides = slides.length;

        function activateSlide(index) {
            tabs.forEach(t => t.classList.remove('activetab'));
            slides.forEach(s => s.classList.remove('activetab'));
            dots.forEach(d => d.classList.remove('activetab'));

            tabs[index].classList.add('activetab');
            slides[index]?.classList.add('activetab');

            const activeSlideDots = slides[index]?.querySelectorAll('.series-dot');
            activeSlideDots?.forEach((dot) => {
                if (dot.getAttribute('data-index') == index) {
                    dot.classList.add('activetab');
                }
            });

            // Update slide pagination (e.g., 1/3)
            const pagination = slides[index]?.querySelector('.series-pagination');
            pagination.textContent = `${parseInt(index) + 1}/${totalSlides}`;
        }

        // Add click event listeners to tabs
        tabs.forEach((tab) => {
            tab.addEventListener('click', () => {
                const index = tab.getAttribute('data-index');
                activateSlide(index);
                console.log("index: "+index);
            });
        });

        // Add click event listeners to dots
        dots.forEach((dot) => {
            dot.addEventListener('click', () => {
                const index = dot.getAttribute('data-index');
                activateSlide(index);
            });
        });

        // Initialize with pagination for the first slide
        activateSlide(0);
    })
</script>


{% schema %}
{
  "name": "Animated Tab Carousel",
  "settings": [
    {
      "type": "text",
      "id": "main_title",
      "label": "Main Title"
    },
    {
      "type": "text",
      "id": "main_subtitle",
      "label": "Main Sub Title"
    },
    {
      "type": "url",
      "id": "main_txt_url_homeowner",
      "label": "Configure Button URL - Homeowner"
    },
    {
        "type": "url",
        "id": "main_txt_url_dealer",
        "label": "Configure Button URL - Dealer"
    }
  ],
   "blocks": [
    {
      "type": "text_block",
      "name": "Tab Block",
      "settings": [
        {
          "type": "text",
          "id": "tab_heading",
          "label": "Tab Heading"
        },
        {
          "type": "textarea",
          "id": "tab_content",
          "label": "Tab Para Text"
        },
       {
          "type": "image_picker",
          "id": "tab_main_img",
          "label": "Main Image"
        },
       {
          "type": "image_picker",
          "id": "tab_icon",
          "label": "Tab Icon"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Animated Tab Carousel"
    }
  ]
}
{% endschema %}